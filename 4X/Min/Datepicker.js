/*@license
ARIA Date Picker Module 5.6 for Apex 4X
Author: Bryan Garaventa (https://www.linkedin.com/in/bgaraventa)
Contributions by Danny Allen (dannya.com) / Wonderscore Ltd (wonderscore.co.uk)
https://github.com/whatsock/apex
License: MIT <https://opensource.org/licenses/MIT>
*/
"setDatepicker"in $A||($A.addWidgetProfile("Datepicker",{configure:function(e){return{returnFocus:!1,allowRerender:!0,exposeBounds:!0,exposeHiddenClose:!1}},role:function(e){return{role:"dialog","aria-modal":"false","aria-label":e.role}},innerRole:function(e){return{role:"application"}}}),$A.extend({setDatepicker:function(h){function m(e){$.alt=e.altKey,$.ctrl=e.ctrlKey,$.shift=e.shiftKey}function n(){d=!1}function t(){d||i.loaded||i.disabled?!d&&i.loaded&&(d=!0,i.remove(),p=g=!1,setTimeout(n,1e3)):(Y=p=!(g=!(d=!0)),$A.trigger(this,"opendatepicker"),setTimeout(n,1e3))}var e=(h=h||{}).helpTextShort||"Press F1 for help.",a=h.helpText||"Press the arrow keys to navigate by day, PageUp and PageDown to navigate by month, Alt+PageUp and Alt+PageDown to navigate by year, or Escape to cancel.",y=!0===h.monthOnly,v=y||!0===h.monthSelect,b=y||!0===h.yearSelect,A=y||!0===h.forceSelect,r=h.openOnFocusHelpText||"Press Down arrow to browse the calendar, or Escape to close.",g=!1,p=!1,o=h.id||$A.genId(),s=$A.morph(h.toggle),x=$A.morph(h.input),f=!y&&!0===h.enableComments,D=$A.isFn(h.onActivate)?h.onActivate:function(e,t){x.value=t.formatDate(t),t.remove(),t.triggerClicked?$A.focus(h.returnFocusTo||s):$A.focus(h.returnFocusTo||x),t.triggerClicked=!1},$={},M=$A.genId(),T=$A([{id:o,role:h.role||"Calendar",widgetType:"Datepicker",autoCloseSameWidget:!0,trigger:s,target:x,on:"opendatepicker",disabled:!0===h.disabled,returnFocus:!1,openOnFocus:!0===h.openOnFocus,openOnFocusHelpText:r,showEscBtn:!0===h.showEscBtn,escBtnName:h.escBtnName||"Close",escBtnIcon:h.escBtnIcon||"&times;",tooltipTxt:h.tooltipTxt||"Press Escape to cancel",markedTxt:h.markedTxt||"Selected",disabledTxt:h.disabledTxt||"Disabled",commentedTxt:h.commentedTxt||"Has Comment",prevTxt:h.prevTxt||"Previous",nextTxt:h.nextTxt||"Next",monthTxt:h.monthTxt||"Month",yearTxt:h.yearTxt||"Year",leftButtonYearText:h.leftButtonYearText||"&#8656;",rightButtonYearText:h.rightButtonYearText||"&#8658;",leftButtonMonthText:h.leftButtonMonthText||"&#8592;",rightButtonMonthText:h.rightButtonMonthText||"&#8594;",drawFullCalendar:!0===h.drawFullCalendar,highlightToday:!$A.isBool(h.highlightToday)||h.highlightToday,pageUpDownNatural:!0,inputDateFormat:h.inputDateFormat||"MM/DD/YYYY",audibleDateFormat:h.audibleDateFormat||"dddd D MMMM YYYY",initialDate:h.initialDate instanceof Date?h.initialDate:new Date,minDate:void 0!==h.minDate?h.minDate instanceof Date?h.minDate:new Date((new Date).setDate((new Date).getDate()+h.minDate)):void 0,maxDate:void 0!==h.maxDate?h.maxDate instanceof Date?h.maxDate:new Date((new Date).setDate((new Date).getDate()+h.maxDate)):void 0,disableWeekdays:void 0!==h.disableWeekdays&&h.disableWeekdays,disableWeekends:void 0!==h.disableWeekends&&h.disableWeekends,className:h.className||"calendar",range:{disabledWDays:[],0:{name:h.months&&h.months[0]?h.months[0]:"January",max:31,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},1:{name:h.months&&h.months[1]?h.months[1]:"February",max:28,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},2:{name:h.months&&h.months[2]?h.months[2]:"March",max:31,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},3:{name:h.months&&h.months[3]?h.months[3]:"April",max:30,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},4:{name:h.months&&h.months[4]?h.months[4]:"May",max:31,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},5:{name:h.months&&h.months[5]?h.months[5]:"June",max:30,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},6:{name:h.months&&h.months[6]?h.months[6]:"July",max:31,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},7:{name:h.months&&h.months[7]?h.months[7]:"August",max:31,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},8:{name:h.months&&h.months[8]?h.months[8]:"September",max:30,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},9:{name:h.months&&h.months[9]?h.months[9]:"October",max:31,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},10:{name:h.months&&h.months[10]?h.months[10]:"November",max:30,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},11:{name:h.months&&h.months[11]?h.months[11]:"December",max:31,marked:{},disabled:{},disabledWDays:[],comments:{},message:{}},wDays:[{shrt:h.days&&h.days[0]?h.days[0].s:"S",lng:h.days&&h.days[0]?h.days[0].l:"Sunday"},{shrt:h.days&&h.days[1]?h.days[1].s:"M",lng:h.days&&h.days[1]?h.days[1].l:"Monday"},{shrt:h.days&&h.days[2]?h.days[2].s:"T",lng:h.days&&h.days[2]?h.days[2].l:"Tuesday"},{shrt:h.days&&h.days[3]?h.days[3].s:"W",lng:h.days&&h.days[3]?h.days[3].l:"Wednesday"},{shrt:h.days&&h.days[4]?h.days[4].s:"T",lng:h.days&&h.days[4]?h.days[4].l:"Thursday"},{shrt:h.days&&h.days[5]?h.days[5].s:"F",lng:h.days&&h.days[5]?h.days[5].l:"Friday"},{shrt:h.days&&h.days[6]?h.days[6].s:"S",lng:h.days&&h.days[6]?h.days[6].l:"Saturday"}],wdOffset:isNaN(h.wdOffset)?0:h.wdOffset},getWDay:function(e,t,n){t=$A.isNum(t)?t:e.range.current.wDay,e=e.range.wdOffset;return e<0?t=t+e<0?7+e:t+e:0<e&&(t=6<t+e?t+e-6-1:t+e),t=n?6-t:t},getDateOrdinalSuffix:function(e){var t=e%10,n=e%100;return 1==t&&11!=n?e+"st":2==t&&12!=n?e+"nd":3==t&&13!=n?e+"rd":e+"th"},formatDate:function(e,t,n){t=t||{YYYY:e.range.current.year,YY:e.range.current.year.toString().slice(-2),MMMM:e.range[e.range.current.month].name,dddd:e.range.wDays[e.range.current.wDay].lng,MM:("00"+(e.range.current.month+1)).slice(-2),DD:("00"+e.range.current.mDay).slice(-2),Do:e.getDateOrdinalSuffix(e.range.current.mDay),M:e.range.current.month+1,D:e.range.current.mDay},$A.isStr(n)||(n=e.inputDateFormat);e=new RegExp(Object.keys(t).join("|"),"gi");return n.replace(e,function(e){return t[e]})},modifyDateValues:function(e,t){for(var n in t){var a=t[n];"month"===n&&(e.month+=a,a<0?e.month<0&&(e.month=11,e.year)&&--e.year:11<e.month&&(e.month=0,e.year)&&(e.year+=1))}return e},setFocus:function(e,t,n){var a=this;return!!e&&(a.current=e,y||(a.query("td.dayInMonth.selected",function(e,t){$A.setAttr(t,{tabindex:"-1"}),$A.remClass(t,"selected"),$A.data(t,"_Selected",0)}),$A.addClass(e,"selected"),$A.data(e,"_Selected",!0),$A.setAttr(e,{tabindex:"0"})),n||("PM"===a.navBtn?(a.buttons.pM.focus(),setTimeout(function(){$A.announce(a.range[a.range.current.month].name,!1,!0)},1),a.navBtnS=!0):"NM"===a.navBtn?(a.buttons.nM.focus(),setTimeout(function(){$A.announce(a.range[a.range.current.month].name,!1,!0)},1),a.navBtnS=!0):"PY"===a.navBtn?(a.buttons.pY.focus(),setTimeout(function(){$A.announce(a.range.current.year.toString(),!1,!0)},1),a.navBtnS=!0):"NY"===a.navBtn?(a.buttons.nY.focus(),setTimeout(function(){$A.announce(a.range.current.year.toString(),!1,!0)},1),a.navBtnS=!0):"CY"===a.navBtn||"CM"===a.navBtn||y&&(!a.openOnFocus||Y)?a.buttons.cYS.hidden?a.buttons.cY.hidden||a.buttons.cY.focus():a.buttons.cYS.focus():(!a.openOnFocus||a.openOnFocus&&!g&&p)&&e.focus()),a.fn.navBtn?a.fn.navBtn="":a.navBtn="",!0)},setCurrent:function(e){e.date instanceof Date&&(e.range.current={mDay:e.date.getDate(),month:e.date.getMonth(),year:e.date.getFullYear(),wDay:e.date.getDay()})},setDayMarked:function(e,t,n){var a=t.getFullYear(),r=t.getMonth(),t=t.getDate();n?("object"!=typeof e.range[r].marked[a]&&(e.range[r].marked[a]=[]),e.range[r].marked[a].push(t)):"object"==typeof e.range[r].marked[a]&&-1!==(n=e.range[r].marked[a].indexOf(t))&&delete e.range[r].marked[a][n]},clearAllMarked:function(e){for(var t in e.range)e.range[t].marked={}},setDayDisabled:function(e,t,n){var a=t.getFullYear(),r=t.getMonth(),t=t.getDate();n?("object"!=typeof e.range[r].disabled[a]&&(e.range[r].disabled[a]=[]),e.range[r].disabled[a].push(t)):"object"==typeof e.range[r].disabled[a]&&-1!==(n=e.range[r].disabled[a].indexOf(t))&&delete e.range[r].disabled[a][n]},setMonthDisabled:function(e,t,n){var a=t.getFullYear(),r=t.getMonth();if(n){e.range[r].disabled[a]=[];for(var o=1;o<=e.range[r].max;o++)e.range[r].disabled[a].push(o)}else e.range[r].disabled[a]=[]},setDayOfWeekDisabled:function(e,t,n,a){for(var r,o=t.getFullYear(),s=t.getMonth(),i=("object"!=typeof e.range[s].disabled[o]&&(e.range[s].disabled[o]=[]),new Date(o,s,1)),d=1;d<=e.range[s].max;d++)i.setDate(d),-1!==n.indexOf(i.getDay())&&(a?e.range[s].disabled[o].push(d):-1!==(r=e.range[s].marked[o].indexOf(d))&&delete e.range[s].marked[o][r])},setWeekdaysDisabled:function(e,t,n){e.setDayOfWeekDisabled(e,t,[1,2,3,4,5],n)},setWeekendsDisabled:function(e,t,n){e.setDayOfWeekDisabled(e,t,[0,6],n)},clearAllDisabled:function(e){for(var t in e.range)e.range[t].disabled={}},setMonthMessage:function(e,t,n){var a=t.getFullYear(),t=t.getMonth();$A.isStr(n)&&0<n.length?e.range[t].message[a]=n:delete e.range[t].message[a]},clearAllMessage:function(e){for(var t in e.range)e.range[t].message={}},isDisabledYear:function(e,t){for(var n=0;n<=11;n++)if(!e.isDisabledMonth(e,n,t))return!1;return!0},isDisabledMonth:function(e,t,n){for(var a=1;a<=e.range[t].max;a++)if(!e.isDisabledDate(e,a,new Date(n,t,a)))return!1;return!0},isDisabledDate:function(e,t,n,a){a=a||e.range.current;var r=e.range[a.month].disabled[a.year],o=e.range[a.month].disabled["*"],a=e.range[a.month].disabledWDays,s=e.range.disabledWDays,i=n.getDay();return!!(r&&-1!==$A.inArray(t,r)||o&&-1!==$A.inArray(t,o)||a.length&&-1!==$A.inArray(i,a)||s.length&&-1!==$A.inArray(i,s)||e.isOutsideDateRange(n))},isOutsideDateRange:function(e){e=this.createDateComparisonValue(e);return this.minDateComparisonValue&&e<this.minDateComparisonValue||this.maxDateComparisonValue&&e>this.maxDateComparisonValue},createDayCell:function(e,t,n,a,r){var o=this,s="<td ",i=o.createDateComparisonValue(new Date),d=o.createDateComparisonValue(t),u=(d===i&&(s+='aria-current="date" '),a&&(s+='aria-disabled="true" '),s+='aria-label="',o.range[o.range.current.month].comments[o.range.current.year]),c=o.range[o.range.current.month].comments["*"],l="",u=(u&&u[e]?l=u[e]:c&&c[e]&&(l=c[e]),l&&(s+=o.commentedTxt.replace(/<|>|\"/g,"")+" "),t.getMonth()),m={YYYY:t.getFullYear(),MMMM:o.range[u].name,dddd:o.range.wDays[t.getDay()].lng,MM:("00"+(u+1)).slice(-2),DD:("00"+e).slice(-2),Do:o.getDateOrdinalSuffix(e),M:u+1,D:e},c=new RegExp(Object.keys(m).join("|"),"gi"),t=(s+=o.audibleDateFormat.replace(c,function(e){return m[e]}),l&&(s+=l.replace(/<|>|\n/g," ").replace(/\"/g,'\\"')),s=s+'" role="button" tabindex="-1" '+('class="day '+(n||"")),!0===o.highlightToday&&d===i&&(s+=" dayToday"),o.range[o.range.current.month].marked[o.range.current.year]&&-1!==o.range[o.range.current.month].marked[o.range.current.year].indexOf(e));return(r&&!a||t)&&(s+=" dayMarked"),a&&(s+=" disabled"),l&&(s+=" comment"),s=s+'" '+'title="',t?s+=o.markedTxt.replace(/<|>|\"/g,""):a&&(s+=o.disabledTxt.replace(/<|>|\"/g,"")),s+='" id="'+o.baseId+e+'"><span aria-hidden="true">'+e+"</span></td>"},createDateComparisonValue:function(e){return parseInt(e.getFullYear()+("00"+e.getMonth()).slice(-2)+("00"+e.getDate()).slice(-2),10)},presetDate:function(e,t,n,a){(e=e||this).initialDate=t||e.initialDate||new Date,e.minDate=n||e.minDate||null,e.maxDate=a||e.maxDate||null,e.setDateComparisons(e),e.date=e.isDisabledDate(e,e.initialDate.getDate(),e.initialDate)?new Date:e.initialDate,e.setCurrent(e),e.fn.current={},$A.extend(!0,e.fn.current,e.range.current)},setDate:function(e,t){void 0===t&&((e.minDate||e.maxDate)&&e.isOutsideDateRange(e.initialDate)?e.initialDate<e.minDate?t=e.minDate:e.initialDate>e.maxDate&&(t=e.maxDate):t=e.initialDate),e.date=t,e.setCurrent(e),e.fn.current={},$A.extend(!0,e.fn.current,e.range.current)},setDateComparisons:function(e){e.minDate instanceof Date&&(e.minDate.setHours(0,0,0,0),e.minDateComparisonValue=e.createDateComparisonValue(e.minDate)),e.maxDate instanceof Date&&(e.maxDate.setHours(0,0,0,0),e.maxDateComparisonValue=e.createDateComparisonValue(e.maxDate)),e.initialDate instanceof Date?e.currentDate=e.initialDate:e.currentDate=new Date,e.currentDateComparisonValue=e.createDateComparisonValue(e.currentDate)},storeCurrentDate:function(e){e.date=new Date(e.range.current.year,e.range.current.month,e.range.current.mDay)},setDisabled:function(e,t){(e="boolean"==typeof e?(t=e,this):e||this).disabled=!!t,$A.setAttr([x,s],"disabled",e.disabled),e.disabled||$A.remAttr([x,s],"disabled")},onceBeforeRender:function(e){e.date instanceof Date||(e.setDateComparisons(e),e.setDate(e))},rerenderTable:function(e){e.rerendering=!0,e.afterRemove(e),e.beforeRender(e),e.duringRender(e),e.afterRender(e),e.rerendering=!1},beforeRender:function(a){var e=x.value.replace(/\.|\-/g,"/"),t=x.value.split("/"),t=(2===t.length?12<t[1]?(2===t[1].length&&(t[1]="20"+t[1]),e=t[0]+"/01/"+t[1]):12<t[0]&&(2===t[0].length&&(t[0]="20"+t[0]),e=t[1]+"/01/"+t[0]):"DD/MM/YYYY"===h.inputDateFormat&&3===t.length?(2===t[2].length&&(t[2]="20"+t[2]),e=t[1]+"/"+t[0]+"/"+t[2]):"MM/DD/YYYY"===h.inputDateFormat&&3===t.length&&(2===t[2].length&&(t[2]="20"+t[2]),e=t[0]+"/"+t[1]+"/"+t[2]),t=e,/^(0?[1-9]|1[0-2])\/(0?[1-9]|[12][0-9]|3[01])\/\d{4}$/.test(t)||/^(0?[1-9]|[12][0-9]|3[01])\/(0?[1-9]|1[0-2])\/\d{4}$/.test(t)),t=(t||(e=a.initialDate),!a.rerendering&&t&&e&&!a.isOutsideDateRange(new Date(e))&&a.presetDate(a,new Date(e)),a.disableWeekdays&&a.setWeekdaysDisabled(a,a.date,!0),a.disableWeekends&&a.setWeekendsDisabled(a,a.date,!0),!$A.isFn(h.configure)||a.stopConfigure||a.configureLoading||(a.configureLoading=a.cancel=!0,a.fn.navBtn=a.navBtn,!0===h.configure.apply(a,[a])&&setTimeout(function(){a.render()},1)),1===a.range.current.month&&(a.range[1].max=1===new Date(a.range.current.year,1,29).getMonth()?29:28),a.baseId=M,a.prevBtnId=a.baseId+"p",a.currentBtnId=a.baseId+"c",a.nextBtnId=a.baseId+"n",a.modifyDateValues({month:a.range.current.month,year:a.range.current.year},{month:-1})),n=new Date,e=(n.setMonth(t.month),n.setFullYear(t.year),a.modifyDateValues({month:a.range.current.month,year:a.range.current.year},{month:1})),r=new Date,o=(r.setMonth(e.month),r.setFullYear(e.year),""),s=(h.condenseYear||(s=!a.isOutsideDateRange(new Date(a.range.current.year-1,0,1)),i=!a.isOutsideDateRange(new Date(a.range.current.year+1,0,1)),o='<tr class="yearSelector" role="presentation"><td class="nav prev btn year'+(s?"":" disabled")+'" accesskey="1" title="'+a.prevTxt.replace(/<|>|\"/g,"")+" "+a.yearTxt.replace(/<|>|\"/g,"")+'" aria-label="'+a.prevTxt.replace(/<|>|\"/g,"")+" "+a.yearTxt.replace(/<|>|\"/g,"")+'"'+(s?' tabindex="0"':' aria-disabled="true" tabindex="-1"')+' role="button" id="'+a.prevBtnId+'Y"><span aria-hidden="true">'+a.leftButtonYearText+'</span></td><td colspan="5" class="year" role="presentation" title="'+a.tooltipTxt.replace(/<|>|\"/g,"")+'">'+(b?"<select "+(A?"":"hidden ")+'class="nav current select year" id="'+a.currentBtnId+'Y" title="'+a.yearTxt.replace(/<|>|\"/g,"")+'" aria-label="'+a.yearTxt.replace(/<|>|\"/g,"")+'">'+function(){var e=h.yearSelectMin||a.range.current.year,t=h.yearSelectMax||a.range.current.year,n="";for(a.minDate instanceof Date&&(e=Math.min(e,a.minDate.getFullYear())),a.maxDate instanceof Date&&(t=Math.max(t,a.maxDate.getFullYear()));e<=t;)a.isDisabledYear(a,e)||(n+="<option"+(e===a.range.current.year?' selected="selected"':"")+" value="+e+">"+e+"</option>"),e++;return n}()+"</select><span "+(A?"hidden ":"")+'class="nav current btn year" tabindex="0" role="button" id="'+a.currentBtnId+'YB">'+a.range.current.year+"</span>":"<span>"+a.range.current.year+"</span>")+'</td><td class="nav next btn year'+(i?"":" disabled")+'" accesskey="2" title="'+a.nextTxt.replace(/<|>|\"/g,"")+" "+a.yearTxt.replace(/<|>|\"/g,"")+'" aria-label="'+a.nextTxt.replace(/<|>|\"/g,"")+" "+a.yearTxt.replace(/<|>|\"/g,"")+'"'+(i?' tabindex="0"':' aria-disabled="true" tabindex="-1"')+' role="button" id="'+a.nextBtnId+'Y"><span aria-hidden="true">'+a.rightButtonYearText+"</span></td></tr>"),!a.isOutsideDateRange(new Date(t.year,t.month,a.range[t.month].max))),i=!a.isOutsideDateRange(new Date(e.year,e.month,1)),e='<tr class="monthSelector" role="presentation"><td class="nav prev btn month'+(s?"":" disabled")+'" accesskey="3" title="'+a.prevTxt.replace(/<|>|\"/g,"")+" "+a.monthTxt.replace(/<|>|\"/g,"")+'" aria-label="'+a.prevTxt.replace(/<|>|\"/g,"")+" "+a.monthTxt.replace(/<|>|\"/g,"")+'"'+(s?' tabindex="0"':' aria-disabled="true" tabindex="-1"')+' role="button" id="'+a.prevBtnId+'"><span aria-hidden="true">'+a.leftButtonMonthText+'</span></td><td colspan="5" class="month" role="presentation">'+(v?"<select "+(A?"":"hidden ")+'class="nav current select month" id="'+a.currentBtnId+'M" title="'+a.monthTxt.replace(/<|>|\"/g,"")+'" aria-label="'+a.monthTxt.replace(/<|>|\"/g,"")+'">'+function(){for(var e="",t=0;t<=11;t++)a.isDisabledMonth(a,t,a.range.current.year)||(e+="<option value="+t+(t===a.range.current.month?' selected="selected"':"")+">"+a.range[t].name+(h.condenseYear?" "+a.range.current.year:"")+"</option>");return e}()+"</select><span "+(A?"hidden ":"")+'class="nav current btn month" tabindex="0" role="button" id="'+a.currentBtnId+'MB">'+a.range[a.range.current.month].name+(h.condenseYear?" "+a.range.current.year:"")+"</span>":"<span>"+a.range[a.range.current.month].name+(h.condenseYear?" "+a.range.current.year:"")+"</span>")+'</td><td class="nav next btn month'+(i?"":" disabled")+'" accesskey="4" title="'+a.nextTxt.replace(/<|>|\"/g,"")+" "+a.monthTxt.replace(/<|>|\"/g,"")+'" aria-label="'+a.nextTxt.replace(/<|>|\"/g,"")+" "+a.monthTxt.replace(/<|>|\"/g,"")+'"'+(i?' tabindex="0"':' aria-disabled="true" tabindex="-1"')+' role="button" id="'+a.nextBtnId+'"><span aria-hidden="true">'+a.rightButtonMonthText+"</span></td></tr>";a.content="",a.content+='<table role="presentation" class="calendar">'+o+e+'<tr role="presentation" aria-hidden="true"'+(y?' hidden="hidden">':">");for(var d=a.iter=0;d<7;d++){var u=a.getWDay(a,d),c=a.range.wDays[u];d||(a.iter=a.iterE=6<u+6?-1+u:u+6,a.iterS=u),a.content+='<th scope="col" class="week" title="'+c.lng+'" role="presentation"><span>'+c.shrt+"</span></th>"}a.content+='</tr><tr role="presentation"'+(y?' hidden="hidden">':">");var l=new Date,m=(l.setDate(1),l.setMonth(a.range.current.month),l.setFullYear(a.range.current.year),l.getDay()),g=(l.setDate(a.range[a.range.current.month].max),l.getDay()),p=a.iterS;for(!0===a.drawFullCalendar&&(f=new Date(t.year,t.month+1,0).getDate()-new Date(a.range.current.year,a.range.current.month,0).getDay()+a.range.wdOffset);p!==m;)p=6<p+1?0:p+1,!0===a.drawFullCalendar?(n.setDate(f),a.content+=a.createDayCell(f,n,"dayInPrevMonth",a.isDisabledDate(a,f,n)),++f):a.content+='<td class="empty" role="presentation"><span>&nbsp;</span></td>';a.range.track={};for(d=1;d<=31;d++)a.range.track[a.baseId+d]=d;for(var f,d=1;d<=a.range[a.range.current.month].max;d++){l.setDate(d);var D=d===a.fn.current.mDay&&a.range.current.month===a.fn.current.month&&a.range.current.year===a.fn.current.year;a.content+=a.createDayCell(d,l,"dayInMonth",a.isDisabledDate(a,d,l),D),(p=l.getDay())===a.iter&&d<a.range[a.range.current.month].max&&(a.content+='</tr><tr role="presentation"'+(y?' hidden="hidden">':">"))}for(!0===a.drawFullCalendar&&(f=1);g!==a.iter;)g=6<g+1?0:g+1,!0===a.drawFullCalendar?(r.setDate(f),a.content+=a.createDayCell(f,r,"dayInNextMonth",a.isDisabledDate(a,f,r)),++f):a.content+='<td class="empty" role="presentation"><span>&nbsp;</span></td>';a.content+="</tr></table>",$A.isNode(a.messageContainer)||(a.messageContainerId=$A.genId(),a.messageContainer=$A.create("div",{id:a.messageContainerId},{},"monthMessage")),a.range[a.range.current.month].message[a.range.current.year]?(a.messageContainer.innerHTML="<p>"+a.range[a.range.current.month].message[a.range.current.year]+"</p>",$A.setAttr(a.container,"aria-labelledby",a.messageContainerId)):(C||(a.messageContainer.innerHTML="<p>"+a.helpTextShort+"</p>"),$A.remAttr(a.container,"aria-labelledby")),a.showEscBtn&&(a.content+='<button id="'+a.baseId+'esc" aria-label="'+a.escBtnName+'" title="'+a.escBtnName+'" class="esc-button">'+a.escBtnIcon+"</button>")},mouseEnter:function(e,t){t.mouseWithin=!0},mouseLeave:function(e,t){t.mouseWithin=!1},click:function(e,t){e.stopPropagation()},keyDown:function(e,t){112===$A.keyEvent(e)&&($A.remAttr(t.container,"aria-labelledby"),t.container.appendChild(t.messageContainer),$A.setAttr(t.messageContainer,{role:"alert"}),C||(t.messageContainer.innerHTML="<p>"+t.helpText+"</p>"),e.preventDefault(),e.stopPropagation())},updateDisabled:function(){this.query('td[aria-disabled="true"]',function(e,t){$A.data(t,"disabled",!0)})},updateCommented:function(){this.query("td.comment",function(e,t){$A.data(t,"_HasComment",!0)})},duringRender:function(e){e.rerendering?e.container.innerHTML=e.content:(e.datepickerLoaded=!1,e.setAttr({title:C?"":e.helpTextShort})),e.messageContainer.innerHTML&&e.container.appendChild(e.messageContainer)},afterRender:function(i){i.buttons={esc:i.showEscBtn?i.container.querySelector("button.esc-button"):null,pY:h.condenseYear?null:$A.get(i.prevBtnId+"Y"),nY:h.condenseYear?null:$A.get(i.nextBtnId+"Y"),pM:$A.get(i.prevBtnId),nM:$A.get(i.nextBtnId)},!h.condenseYear&&i.disableNavPrevYearBtn&&$A.setAttr(i.buttons.pY,"aria-disabled","true"),!h.condenseYear&&i.disableNavNextYearBtn&&$A.setAttr(i.buttons.nY,"aria-disabled","true"),i.disableNavPrevMonthBtn&&$A.setAttr(i.buttons.pM,"aria-disabled","true"),i.disableNavNextMonthBtn&&$A.setAttr(i.buttons.nM,"aria-disabled","true"),i.prevCurrent||(i.prevCurrent={}),$A.extend(!0,i.prevCurrent,i.range.current),i.updateDisabled(),i.updateCommented();function d(){var e,t;i.disableNavNextMonthBtn&&$A.data(i.buttons.nM,"disabled")||($A.extend(!0,i.prevCurrent,i.range.current),t=i.modifyDateValues({month:i.range.current.month,year:i.range.current.year},{month:1}),i.isOutsideDateRange(new Date(t.year,t.month,1))||(e=i.range.current.mDay>i.range[t.month].max?i.range[t.month].max:i.range.current.mDay,t=new Date(t.year,t.month,e),i.isOutsideDateRange(t))?i.date=i.maxDate:i.date=t,i.setCurrent(i),i.rerenderTable(i))}function u(){var e,t;i.disableNavPrevMonthBtn&&$A.data(i.buttons.pM,"disabled")||($A.extend(!0,i.prevCurrent,i.range.current),t=i.modifyDateValues({month:i.range.current.month,year:i.range.current.year},{month:-1}),i.isOutsideDateRange(new Date(t.year,t.month,i.range[t.month].max))||(e=i.range.current.mDay>i.range[t.month].max?i.range[t.month].max:i.range.current.mDay,t=new Date(t.year,t.month,e),i.isOutsideDateRange(t))?i.date=i.minDate:i.date=t,i.setCurrent(i),i.rerenderTable(i))}function c(e){var t,n;!e&&(!h.condenseYear&&$A.data(i.buttons.pY,"disabled")||h.condenseYear&&i.disableNavPrevYearBtn)||e&&(!h.condenseYear&&$A.data(i.buttons.nY,"disabled")||h.condenseYear&&i.disableNavNextYearBtn)||($A.extend(!0,i.prevCurrent,i.range.current),t=i.range.current.month,e=e?i.range.current.year+1:i.range.current.year-1,1===t&&(i.range[1].max=28),n=i.range.current.mDay>i.range[t].max?i.range[t].max:i.range.current.mDay,e=new Date(e,t,n),i.isOutsideDateRange(e))||(i.date=e,i.setCurrent(i),i.rerenderTable(i))}var n,e,a,r,l=!1;y||$A.on("#"+i.containerId+" td.day",{focus:function(e){var t,n,a;$A.data(this,"_HasComment")?(t=i.range[i.range.current.month].comments[i.range.current.year],n=i.range[i.range.current.month].comments["*"],a="",t&&t[i.range.current.mDay]?a=t[i.range.current.mDay]:n&&n[i.range.current.mDay]&&(a=n[i.range.current.mDay]),(a=$A.trim(a.replace(/<|>/g,"")))&&(k.content=a,k.rerender(function(){w.openEditor&&(w.openEditor=!1,w.loaded)&&w.reset()}))):k.loaded&&k.remove()},click:function(e){var t;$A.hasClass(this,"dayInPrevMonth")?(t=i.modifyDateValues({month:i.range.current.month,year:i.range.current.year},{month:-1}),i.date=new Date(t.year,t.month,i.range.track[this.id])):$A.hasClass(this,"dayInNextMonth")?(t=i.modifyDateValues({month:i.range.current.month,year:i.range.current.year},{month:1}),i.date=new Date(t.year,t.month,i.range.track[this.id])):i.date.setDate(i.range.track[this.id]),i.setCurrent(i),$A.data(this,"_Selected")||!f&&!$A.data(this,"_HasComment")?$A.data(this,"disabled")?(e.stopPropagation(),e.preventDefault()):($A.extend(!0,i.fn.current,i.range.current),p=!(g=!1),i.storeCurrentDate(i),D.apply(this,[e,i,x])):i.setFocus(this),e.preventDefault()},keydown:function(e){m(e);var t,n=$A.keyEvent(e);if(13===n)l=!0,$A.data(this,"disabled")||($A.extend(!0,i.fn.current,i.range.current),p=!(g=!1),i.storeCurrentDate(i),D.apply(this,[e,i,x])),e.preventDefault();else if(32===n&&f&&h.editor&&h.editor.show&&!w.openEditor)w.openEditor=!0,w.reset(),e.preventDefault();else if(37<=n&&n<=40||27===n||33<=n&&n<=36){var a,r,o,s=i.range.current.wDay;if(37===n)$A.extend(!0,i.prevCurrent,i.range.current),1<i.range.current.mDay?(i.range.current.mDay--,i.range.current.wDay=s?s-1:6,i.setFocus(i.range.index[i.range.current.mDay-1],this)):1!==i.range.current.mDay||$A.data(i.buttons.pM,"disabled")||(a=i.modifyDateValues({month:i.range.current.month,year:i.range.current.year},{month:-1}),r=i.range[a.month].max,1===a.month&&(r=1===new Date(a.year,1,29).getMonth()?29:28),i.date=new Date(a.year,a.month,r),i.setCurrent(i),i.rerenderTable(i));else if(39===n)$A.extend(!0,i.prevCurrent,i.range.current),i.range.current.mDay<i.range[i.range.current.month].max?(i.range.current.mDay++,i.range.current.wDay=6===s?0:s+1,i.setFocus(i.range.index[i.range.current.mDay-1],this)):i.range.current.mDay!=i.range[i.range.current.month].max||$A.data(i.buttons.nM,"disabled")||(a=i.modifyDateValues({month:i.range.current.month,year:i.range.current.year},{month:1}),i.date=new Date(a.year,a.month,1),i.setCurrent(i),i.rerenderTable(i));else if(38===n)$A.extend(!0,i.prevCurrent,i.range.current),0<i.range.current.mDay-7?(i.range.current.mDay-=7,i.setFocus(i.range.index[i.range.current.mDay-1],this)):$A.data(i.buttons.pM,"disabled")||(1===(a=i.modifyDateValues({month:i.range.current.month,year:i.range.current.year},{month:-1})).month&&1===new Date(a.year,1,29).getMonth()?i.range[a.month].max=29:1===a.month&&(i.range[a.month].max=28),r=i.range[a.month].max+(i.range.current.mDay-7),o=new Date(a.year,a.month,r),i.isOutsideDateRange(o))||(i.date=o,i.setCurrent(i),i.rerenderTable(i));else if(40===n)$A.extend(!0,i.prevCurrent,i.range.current),i.range.current.mDay+7<=i.range[i.range.current.month].max?(i.range.current.mDay+=7,i.setFocus(i.range.index[i.range.current.mDay-1],this)):$A.data(i.buttons.nM,"disabled")||(a=i.modifyDateValues({month:i.range.current.month,year:i.range.current.year},{month:1}),r=i.range.current.mDay+7-i.range[i.range.current.month].max,o=new Date(a.year,a.month,r),i.isOutsideDateRange(o))||(i.date=o,i.setCurrent(i),i.rerenderTable(i));else if(27===n)i.remove(),p=!(g=!1),$A.focus(h.returnFocusTo||x);else if(33===n)$A.extend(!0,i.prevCurrent,i.range.current),i.pageUpDownNatural?$.alt?c(!1):u():$.alt?c(!0):d();else if(34===n)$A.extend(!0,i.prevCurrent,i.range.current),i.pageUpDownNatural?$.alt?c(!0):d():$.alt?c(!1):u();else if(36===n){if($A.extend(!0,i.prevCurrent,i.range.current),s!==i.iterS&&1<i.range.current.mDay){for(;i.range.current.wDay!==i.iterS&&$A.get(i.baseId+(i.range.current.mDay-1));)i.range.current.wDay=i.range.current.wDay-1<0?6:i.range.current.wDay-1,i.range.current.mDay--;i.setFocus(i.range.index[i.range.current.mDay-1],this)}}else if(35===n&&($A.extend(!0,i.prevCurrent,i.range.current),s!==i.iterE)&&i.range.current.mDay<i.range[i.range.current.month].max){for(;i.range.current.wDay!==i.iterE&&$A.get(i.baseId+(i.range.current.mDay+1));)i.range.current.wDay=6<i.range.current.wDay+1?0:i.range.current.wDay+1,i.range.current.mDay++;i.setFocus(i.range.index[i.range.current.mDay-1],this)}e.preventDefault()}else 9!==n||$.alt||$.ctrl||$.shift?9!==n||$.alt||$.ctrl||!$.shift||($A.extend(!0,i.prevCurrent,i.range.current),i.navUpdate(),t=i.nav[i.nav.length-1],$A.isNode(t)?t.focus():f&&w.loaded&&w.commentBtn.focus(),e.preventDefault()):($A.extend(!0,i.prevCurrent,i.range.current),f&&w.loaded?($A.isHidden(w.textarea)?w.commentBtn:w.textarea).focus():(i.navUpdate(),t=i.nav[0],$A.isNode(t)&&t.focus()),e.preventDefault())},keyup:function(e){m(e),13!==$A.keyEvent(e)||l||i.isAdd||($A.data(this,"disabled")||($A.extend(!0,i.fn.current,i.range.current),i.setFocus.firstOpen)||(p=!(g=!1),i.storeCurrentDate(i),D.apply(this,[e,i,x])),e.preventDefault()),l=i.setFocus.firstOpen=i.isAdd=!1}},"."+M),i.showEscBtn&&$A.on(i.buttons.esc,{click:function(e){i.remove(),p=!(g=!1),$A.focus(h.returnFocusTo||x),e.preventDefault()},keydown:function(e){m(e);var t,n=$A.keyEvent(e);27===n||13===n||32===n?(i.remove(),p=!(g=!1),$A.focus(h.returnFocusTo||x)):9!==n||$.alt||$.ctrl||$.shift?9!==n||$.alt||$.ctrl||!$.shift||(t=i.navTo(this,0),($A.isNode(t)?t:f&&w.loaded?w.commentBtn:T.current).focus(),e.preventDefault()):(t=i.navTo(this,1),($A.isNode(t)?t:T.current).focus(),e.preventDefault())},keyup:function(e){m(e)}},"."+M),b&&!h.condenseYear&&(e=$A.get("#"+i.currentBtnId+"Y"),n=e.querySelectorAll("option"),i.buttons.cYS=e,i.buttons.cY=$A.get("#"+i.currentBtnId+"YB"),$A.on(e,{keydown:function(e){m(e);var t,n=$A.keyEvent(e);27===n?(A?(i.remove(),p=!(g=!1),$A.focus(h.returnFocusTo||x)):(i.buttons.cYS.hidden=!0,i.buttons.cY.hidden=!1,i.buttons.cY.focus()),e.stopPropagation(),e.preventDefault()):9!==n||$.alt||$.ctrl||$.shift?9!==n||$.alt||$.ctrl||!$.shift||A&&(t=i.navTo(this,0),($A.isNode(t)?t:f&&w.loaded?w.commentBtn:T.current).focus(),e.preventDefault()):A&&(t=i.navTo(this,1),($A.isNode(t)?t:T.current).focus(),e.preventDefault())},keyup:function(e){m(e)},change:function(e){var t;i.navBtn="CY",t=function(){for(var e=0;e<n.length;e++)if(n[e].selected)return parseInt($A.getAttr(n[e],"value"));return i.range.current.year}(),A||(i.buttons.cYS.hidden=!0,i.buttons.cY.hidden=!1),t!==i.range.current.year?(i.initialDate=new Date(t,i.range.current.month,i.range.current.mDay),i.setDate(i),i.rerenderTable(i)):i.buttons[A?"cYS":"cY"].focus()}},"."+M),$A.on(i.buttons.cY,{click:function(e){A||(i.buttons.cY.hidden=!0,i.buttons.cYS.hidden=!1,i.buttons.cYS.focus()),e.preventDefault()},keydown:function(e){m(e);var t,n=$A.keyEvent(e);13===n||32===n?(A||(i.buttons.cY.hidden=!0,i.buttons.cYS.hidden=!1,i.buttons.cYS.focus()),e.preventDefault()):27===n?(i.remove(),p=!(g=!1),$A.focus(h.returnFocusTo||x)):9!==n||$.alt||$.ctrl||$.shift?9!==n||$.alt||$.ctrl||!$.shift||(t=i.navTo(this,0),($A.isNode(t)?t:f&&w.loaded?w.commentBtn:T.current).focus(),e.preventDefault()):(t=i.navTo(this,1),($A.isNode(t)?t:T.current).focus(),e.preventDefault())},keyup:function(e){m(e)}},"."+M)),v&&(e=$A.get("#"+i.currentBtnId+"M"),a=e.querySelectorAll("option"),i.buttons.cMS=e,i.buttons.cM=$A.get("#"+i.currentBtnId+"MB"),$A.on(e,{click:function(e){y&&(p=!(g=!1),i.storeCurrentDate(i),D.apply(this,[e,i,x]))},keydown:function(e){m(e);var t,n=$A.keyEvent(e);13===n?y&&(p=!(g=!1),i.storeCurrentDate(i),D.apply(this,[e,i,x])):27===n?(A?(i.remove(),p=!(g=!1),$A.focus(h.returnFocusTo||x)):(i.buttons.cMS.hidden=!0,i.buttons.cM.hidden=!1,i.buttons.cM.focus()),e.stopPropagation(),e.preventDefault()):9!==n||$.alt||$.ctrl||$.shift?9!==n||$.alt||$.ctrl||!$.shift||A&&(t=i.navTo(this,0),($A.isNode(t)?t:f&&w.loaded?w.commentBtn:T.current).focus(),e.preventDefault()):A&&(t=i.navTo(this,1),($A.isNode(t)?t:T.current).focus(),e.preventDefault())},keyup:function(e){m(e)},change:function(e){var t;i.navBtn="cM",t=function(){for(var e=0;e<a.length;e++)if(a[e].selected)return parseInt($A.getAttr(a[e],"value"));return i.range.current.month}(),A||(i.buttons.cMS.hidden=!0,i.buttons.cM.hidden=!1),t!==i.range.current.month?(i.initialDate=new Date(i.range.current.year,t,i.range.current.mDay),i.setDate(i),i.rerenderTable(i)):i.buttons[A?"cMS":"cM"].focus(),y&&(p=!(g=!1),i.storeCurrentDate(i),D.apply(this,[e,i,x]))}},"."+M),$A.on(i.buttons.cM,{click:function(e){A||(i.buttons.cM.hidden=!0,i.buttons.cMS.hidden=!1,i.buttons.cMS.focus()),e.preventDefault()},keydown:function(e){m(e);var t,n=$A.keyEvent(e);13===n||32===n?(A||(i.buttons.cM.hidden=!0,i.buttons.cMS.hidden=!1,i.buttons.cMS.focus()),e.preventDefault()):27===n?(i.remove(),p=!(g=!1),$A.focus(h.returnFocusTo||x)):9!==n||$.alt||$.ctrl||$.shift?9!==n||$.alt||$.ctrl||!$.shift||(t=i.navTo(this,0),($A.isNode(t)?t:f&&w.loaded?w.commentBtn:T.current).focus(),e.preventDefault()):(t=i.navTo(this,1),($A.isNode(t)?t:T.current).focus(),e.preventDefault())},keyup:function(e){m(e)}},"."+M)),$A.on(i.buttons.pM,{click:function(e){i.navBtn="PM",u(),e.preventDefault()},keydown:function(e){m(e);var t,n=$A.keyEvent(e);13===n||32===n?(i.navBtn="PM",u(),e.preventDefault()):27===n?(i.remove(),p=!(g=!1),$A.focus(h.returnFocusTo||x),e.preventDefault()):h.condenseYear||38!==n?39===n?(i.buttons.nM.focus(),e.preventDefault()):37===n||40===n?e.preventDefault():9!==n||$.alt||$.ctrl||$.shift?9!==n||$.alt||$.ctrl||!$.shift||(t=i.navTo(this,0),($A.isNode(t)?t:f&&w.loaded?w.commentBtn:T.current).focus(),e.preventDefault()):(t=i.navTo(this,1),($A.isNode(t)?t:T.current).focus(),e.preventDefault()):(i.buttons.pY.focus(),e.preventDefault())},keyup:function(e){m(e)}},"."+M),$A.on(i.buttons.nM,{click:function(e){i.navBtn="NM",d(),e.preventDefault()},keydown:function(e){m(e);var t,n=$A.keyEvent(e);13===n||32===n?(i.navBtn="NM",d(),e.preventDefault()):27===n?(i.remove(),p=!(g=!1),$A.focus(h.returnFocusTo||x),e.preventDefault()):h.condenseYear||38!==n?37===n?(i.buttons.pM.focus(),e.preventDefault()):39===n||40===n?e.preventDefault():9!==n||$.alt||$.ctrl||$.shift?9!==n||$.alt||$.ctrl||!$.shift||(i.navUpdate(),t=i.navTo(this,0),($A.isNode(t)?t:f&&w.loaded?w.commentBtn:T.current).focus(),e.preventDefault()):(y?(i.navUpdate(),t=i.nav[0],$A.isNode(t)&&t.focus()):T.current.focus(),e.preventDefault()):(i.buttons.nY.focus(),e.preventDefault())},keyup:function(e){m(e)}},"."+M),h.condenseYear||$A.on(i.buttons.pY,{click:function(e){i.navBtn="PY",c(),e.preventDefault()},keydown:function(e){m(e);var t,n=$A.keyEvent(e);13===n||32===n?(i.navBtn="PY",c(),e.preventDefault()):27===n?(i.remove(),p=!(g=!1),$A.focus(h.returnFocusTo||x),e.preventDefault()):39===n?(i.buttons.nY.focus(),e.preventDefault()):40===n?(i.buttons.pM.focus(),e.preventDefault()):37===n||38===n?e.preventDefault():9!==n||$.alt||$.ctrl||$.shift?9!==n||$.alt||$.ctrl||!$.shift||(t=i.navTo(this,0),($A.isNode(t)?t:f&&w.loaded?w.commentBtn:y?i.buttons.nM:T.current).focus(),e.preventDefault()):(t=i.navTo(this,1),($A.isNode(t)?t:T.current).focus(),e.preventDefault())},keyup:function(e){m(e)}},"."+M),h.condenseYear||$A.on(i.buttons.nY,{click:function(e){i.navBtn="NY",c(!0),e.preventDefault()},keydown:function(e){m(e);var t,n=$A.keyEvent(e);13===n||32===n?(i.navBtn="NY",c(!0),e.preventDefault()):27===n?(i.remove(),p=!(g=!1),$A.focus(h.returnFocusTo||x),e.preventDefault()):37===n?(i.buttons.pY.focus(),e.preventDefault()):40===n?(i.buttons.nM.focus(),e.preventDefault()):38===n||39===n?e.preventDefault():9!==n||$.alt||$.ctrl||$.shift?9!==n||$.alt||$.ctrl||!$.shift||(t=i.navTo(this,0),($A.isNode(t)?t:f&&w.loaded?w.commentBtn:T.current).focus(),e.preventDefault()):(t=i.navTo(this,1),($A.isNode(t)?t:T.current).focus(),e.preventDefault())},keyup:function(e){m(e)}},"."+M),r=["esc","pY","cY","cYS","nY","pM","cM","cMS","nM"],i.navUpdate=function(){i.nav=[];for(var e=0;e<r.length;e++){var t=i.buttons[r[e]];t&&!$A.isDisabled(t)&&!$A.isHidden(t)&&$A.isFocusable(t)&&i.nav.push(t)}},i.navUpdate(),i.navTo=function(e,t){return i.navUpdate(),y?e!==i.nav[0]||t?e===i.nav[i.nav.length-1]&&t?i.nav[0]:i.nav[$A.inArray(e,i.nav)+(t?1:-1)]:i.nav[i.nav.length-1]:!(!i.nav.length||e===i.nav[0]&&!t||e===i.nav[i.nav.length-1]&&t)&&i.nav[$A.inArray(e,i.nav)+(t?1:-1)]||null},i.range.index=i.container.querySelectorAll("td.dayInMonth"),i.setFocus.firstOpen=!0,i.setFocus(i.range.index[i.range.current.mDay-1]),i.rerendering||(f&&h.editor&&h.editor.show&&w.render(),i.openOnFocus&&$A.setAttr(x,"aria-expanded","true"),$A.setAttr(i.triggerNode,"aria-expanded","true"),setTimeout(function(){i.datepickerLoaded=!0},750)),Y=!1},helpTextShort:e,helpText:a,afterRemove:function(e){e.rerendering||(h.resetCurrent&&(e.date=new Date,e.setCurrent(e),$A.extend(!0,e.fn.current,e.range.current)),f&&k.remove(),f&&h.editor&&h.editor.show&&(w.lock=!1,w.remove()),$A.setAttr(e.triggerNode,"aria-expanded","false")),$A.isFn(h.configure)&&(e.lock=e.configureLoading=!1)}}],h)[0],k=$A(T,[{id:o+"commentTooltip",role:h.comments&&h.comments.role||"Comment",widgetType:"Datepicker",returnFocus:!1,className:h.comments&&h.comments.className||"commentTooltip",beforeRender:function(e){e.targetNode=e.parent.wrapper}}],h.comments&&h.comments.config||{})[0],w=$A(T,[{id:o+"commentAdd",role:h.editor&&h.editor.role||"Edit",widgetType:"Datepicker",className:h.editor&&h.editor.className||"commentAdd",openEditor:!1,content:'<textarea style="visibility: hidden; display: none;" class="commentTa" title="'+k.role+'"></textarea><button title="'+(h.editor&&h.editor.role||"Edit")+" "+k.role+'" class="commentBtn">'+(h.editor&&h.editor.role||"Edit")+"</button>",beforeRender:function(e){e.targetNode=e.parent.wrapper},click:function(e,t){e.stopPropagation()},duringRender:function(e){$A.setAttr(e.wrapper,{role:"dialog","aria-modal":"false","aria-label":e.role}),$A.setAttr(e.container,"role","application")},add:function(e){var t=$A.trim(e.textarea.value.replace(/<|>|\n/g," ")),n=(e.comments[e.parent.range.current.year]||(e.comments[e.parent.range.current.year]={}),e.comments[e.parent.range.current.year][e.parent.range.current.mDay]=t,e.parent.range.current.mDay+", "+e.parent.range.wDays[e.parent.range.current.wDay].lng+" "+e.parent.range[e.parent.range.current.month].name+" "+e.parent.range.current.year),a="";(e.parent.range[e.parent.range.current.month].disabled[e.parent.range.current.year]&&-1!==$A.inArray(e.parent.range.current.mDay,e.parent.range[e.parent.range.current.month].disabled[e.parent.range.current.year])||e.parent.range[e.parent.range.current.month].disabled["*"]&&-1!==$A.inArray(e.parent.range.current.mDay,e.parent.range[e.parent.range.current.month].disabled["*"]))&&(a+=e.parent.disabledTxt.replace(/<|>|\"/g,"")+" "),t?($A.addClass(e.parent.current,"comment"),$A.data(e.parent.current,"_HasComment",!0),a+=e.parent.commentedTxt.replace(/<|>|\"/g,"")+" "):($A.remClass(e.parent.current,"comment"),$A.data(e.parent.current,"_HasComment",!1)),n=a+n,$A.setAttr(e.parent.current,{title:$A.trim(a),"aria-label":n+" "+t.replace(/\"/g,'"')})},reset:function(){var e,n=this;n.loaded&&(n.openEditor?(n.textarea?($A.css(n.textarea,{visibility:"",display:""}),n.css("left",n.parent.wrapper.offsetLeft)):n.textarea=n.query("textarea",function(){$A.css(this,{visibility:"",display:""}),n.css("left",n.parent.wrapper.offsetLeft),$A.on(this,{focus:function(e){k.loaded&&k.remove()},keydown:function(e){var t=$A.keyEvent(e);800<this.value.length&&(this.value=this.value.substring(0,799)),13===t?(n.parent.isAdd=!0,n.add.apply(this,[n]),n.parent.current.focus(),n.openEditor=!1,n.reset(),e.preventDefault()):27===t&&(n.parent.current.focus(),n.openEditor=!1,n.reset(),e.preventDefault())}},"."+M)})[0],$A.setAttr(n.textarea,{title:n.parent.range.current.mDay+", "+n.parent.range.wDays[n.parent.range.current.wDay].lng+" "+n.parent.range[n.parent.range.current.month].name+" "+n.parent.range.current.year}).focus(),n.comments=n.parent.range[n.parent.range.current.month].comments,(e=n.comments[n.parent.range.current.year]&&n.comments[n.parent.range.current.year][n.parent.range.current.mDay]||n.comments["*"]&&n.comments["*"][n.parent.range.current.mDay]||"")&&(n.textarea.value=e),$A.setAttr(n.commentBtn,{title:(h.editor&&h.editor.action1||"Save")+" "+k.role}).innerHTML=h.editor&&h.editor.action1||"Save"):(n.textarea&&(n.textarea.value="",$A.css(n.textarea,{visibility:"hidden",display:"none"})),n.css("left",n.parent.wrapper.offsetLeft+n.parent.wrapper.offsetWidth-n.wrapper.offsetWidth),$A.setAttr(n.commentBtn,{title:(h.editor&&h.editor.role||"Edit")+" "+k.role}).innerHTML=h.editor&&h.editor.role||"Edit"))},afterRender:function(n){n.textarea=n.container.querySelector("textarea"),n.commentBtn=n.container.querySelector("button"),$A.on(n.commentBtn,{focus:function(e){k.loaded&&k.remove()},click:function(e){n.openEditor?(n.parent.isAdd=!0,n.add.apply(n.commentBtn,[n]),n.parent.current.focus(),n.openEditor=!1):n.openEditor=!0,n.reset(),e.preventDefault()},keydown:function(e){var t=$A.keyEvent(e);27===t?(n.openEditor&&(n.parent.current.focus(),n.openEditor=!1,n.reset()),e.preventDefault()):9!==t||e.altKey||e.shiftKey||e.ctrlKey?9!==t||$.alt||$.ctrl||!$.shift||(($A.isHidden(w.textarea)?T.current:w.textarea).focus(),e.preventDefault()):(t=n.parent.nav[0],($A.isNode(t)?t:T.current).focus(),e.preventDefault())}},"."+M),n.reset(),n.lock=!0,$A.on(n.textarea,"keydown",function(e){var t=$A.keyEvent(e);27===t?(n.openEditor&&(n.parent.current.focus(),n.openEditor=!1,n.reset()),e.preventDefault()):9!==t||e.altKey||e.ctrlKey||!e.shiftKey?13===t&&(n.commentBtn.click(),e.preventDefault()):(T.current.focus(),e.preventDefault())},"."+M)},beforeRemove:function(e){e.openEditor=!1,e.textarea=null,e.parent.setFocus.firstOpen=!0},lock:!(f&&h.editor&&h.editor.show)}],h.editor&&h.editor.config||{})[0],i=($A.on(window,"resize",function(e){T.setPosition(),k.setPosition(),w.setPosition(),w.reset()},"."+M),$A.setAttr(s,"aria-expanded","false"),T),d=!1,Y=!1,C=($A.on(s,{click:function(e){t.call(this),e.preventDefault()},keydown:function(e){32===$A.keyEvent(e)&&(t.call(this),e.preventDefault(),e.stopPropagation())}},"."+M),!1);return!0===h.openOnFocus?($A.setAttr(x,"aria-expanded","false"),$A.on(x,{touchstart:function(e){C=!0,d||i.loaded||g||p||i.disabled||(d=!0,$A.trigger(s,"opendatepicker"),e.preventDefault(),setTimeout(n,1e3))},focus:function(e){!C||d||i.loaded||g||!p?d||i.loaded||g||p||i.disabled||(d=!0,$A.trigger(s,"opendatepicker"),C||setTimeout(function(){$A.announce(i.openOnFocusHelpText)},1),setTimeout(n,1e3)):(e.preventDefault(),this.blur(),s&&$A.focus(h.returnFocusTo||s)),p=!(g=!0)},mousedown:function(e){this.blur(),g=p=!1,this.focus()},blur:function(e){i.loaded&&g&&!p&&!i.mouseWithin&&i.remove(),g=!1},keydown:function(e){var t=$A.keyEvent(e);40===t&&g&&!p&&i.loaded?(p=!(g=!1),y?i.buttons.cMS.hidden?i.buttons.cM.hidden||i.buttons.cM.focus():i.buttons.cMS.focus():i.setFocus(i.range.index[i.range.current.mDay-1]),e.preventDefault(),e.stopPropagation()):40!==t||i.loaded||d||i.disabled?27===t&&g&&!p&&i.loaded?(p=g=!1,i.remove(),e.preventDefault(),e.stopPropagation()):9===t&&g&&!p&&i.loaded&&e.shiftKey?(p=g=!1,i.remove()):9===t&&g&&!p&&i.loaded&&!e.shiftKey&&(p=!(g=!1),y?i.buttons.cMS.hidden?i.buttons.cM.hidden||i.buttons.cM.focus():i.buttons.cMS.focus():i.setFocus(i.range.index[i.range.current.mDay-1]),setTimeout(function(){$A.announce(i.helpTextShort)},1),e.preventDefault(),e.stopPropagation()):(p=!(g=d=!0),$A.trigger(s,"opendatepicker"),setTimeout(n,1e3),p=!(g=!1),y?i.buttons.cMS.hidden?i.buttons.cM.hidden||i.buttons.cM.focus():i.buttons.cMS.focus():i.setFocus(i.range.index[i.range.current.mDay-1]),e.preventDefault(),e.stopPropagation())}},"."+M)):$A.on(x,{touchstart:function(e){C=!0},focus:function(e){!C||d||i.loaded||g||!p||(e.preventDefault(),this.blur(),s&&$A.focus(h.returnFocusTo||s)),p=!(g=!0)}}),i.setDisabled(i,i.disabled),$A(s).describedBy(x).controls(x),$A.on("body","click",function(e){T.datepickerLoaded&&T.remove()},"."+M),T}}));